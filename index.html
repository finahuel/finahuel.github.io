<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ice Cream Rolls — Pedidos</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#e7f6fa;
  --accent:#f46da0;
  --accent-2:#ffd66b;
  --card:#ffffff;
  --muted:#6b6b6b;
  --shadow: 0 10px 30px rgba(12,12,12,0.06);
}

/* Normal */
*{ box-sizing:border-box; }
html, body { margin:0; padding:0; min-width:0; overflow-x:hidden; }
body{
  font-family:Inter,system-ui,"Helvetica Neue",Arial;
  background:linear-gradient(180deg,var(--bg) 0%, #ffffff 120%);
  -webkit-font-smoothing:antialiased;
  padding-bottom: 84px; /* espacio para footer fijo */
}

.wrap{ max-width:980px; margin:0 auto; padding:18px; }
header{ display:flex; align-items:center; gap:14px; padding:10px 6px; }
.brand{ display:flex; align-items:center; gap:12px; width:100%; }
.logo{ width:72px; height:72px; border-radius:14px; flex:0 0 72px; overflow:hidden; box-shadow:var(--shadow); display:flex; align-items:center; justify-content:center; }
.logo img{ width:100%; height:100%; object-fit:cover; }

h1{ margin:0; font-size:18px; font-weight:700; }
.lead{ font-size:13px; color:var(--muted); margin:0; }

/* GRID layout: columna principal flexible + sidebar hasta 380px */
.layout{
  display:grid;
  grid-template-columns: minmax(0,1fr) minmax(0,380px);
  gap:18px;
  padding:8px;
  align-items:start;
}
/* permitir que los hijos encogan (evita que un min-width interno rompa la grid) */
.layout > * { min-width: 0; }

/* Card */
.card{
  background:#fff; padding:14px; border-radius:16px;
  box-shadow:var(--shadow);
}

/* Productos (grilla interna) */
.products{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap:12px;
  min-width:0;
}

.product{ border-radius:12px; overflow:hidden; background:#fffefc; display:flex; flex-direction:column; }
.product img{
  display:block;
  width:100%;
  height:150px;
  object-fit:cover;
  background:#f7f7f7;
  min-width:0;
}
.product-body{ padding:12px; display:flex; flex-direction:column; gap:8px; flex:1; }
.product-title{ font-weight:700; font-size:15px; }
.price{ font-weight:800; color:var(--accent); }

/* Buttons */
.btn{ padding:8px 12px; border-radius:10px; border:0; cursor:pointer; font-weight:700; }
.btn-primary{ background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#fff; }
.btn-ghost{ background:transparent; border:1px solid #ddd; }

/* Modal */
#modal{ position:fixed; left:0; top:0; width:100%; height:100%; display:none; align-items:center; justify-content:center; padding:18px; z-index:120; }
#modal .sheet{ width:100%; max-width:760px; background:#fff; border-radius:14px; padding:14px; box-shadow:var(--shadow); max-height:90vh; overflow:auto; -webkit-overflow-scrolling:touch; }
#modal img{ width:140px; height:110px; object-fit:cover; border-radius:8px; }

/* Toppings / sauces */
.topping-grid{ display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; }
.chip{ padding:8px 10px; border-radius:12px; border:1px solid #eee; cursor:pointer; background:#fff; }
.chip.active{ background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#fff; border-color:transparent; }
.sauce-list{ display:flex; gap:8px; margin-top:8px; }
.sauce{ padding:8px 12px; border-radius:12px; border:1px solid #eee; cursor:pointer; background:#fff; }
.sauce.active{ background:var(--accent); color:white; }

/* Carrito */
.cart{ display:flex; flex-direction:column; gap:12px; }
.cart-list{ max-height:320px; overflow:auto; padding-right:6px; }
.cart-row{ display:flex; justify-content:space-between; gap:10px; padding:10px 0; border-bottom:1px solid #eee; }

/* Footer fijo */
.fixed-footer{
  position:fixed; left:0; right:0; bottom:0;
  background:#fff; padding:12px; border-top:1px solid #eee;
  display:flex; justify-content:space-between; align-items:center; z-index:200;
  box-shadow: 0 -6px 18px rgba(12,12,12,0.06);
}
.fixed-total{ font-weight:800; font-size:18px; }
.fixed-button{ background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#fff; padding:12px 16px; border-radius:12px; border:0; font-weight:800; cursor:pointer; }

/* Actions row: responsive adjustments */
@media(max-width:560px){
  .actions-row{ flex-wrap:wrap; width:100%; }
  .actions-row button{ width:100%; }
}

/* PAYMENT & FORM styling small */
.payment-msg{ font-size:12px; color:var(--accent); margin-top:4px; display:none; }

/* nice form */
.nice-form{ display:flex; flex-direction:column; gap:14px; }
.form-field{ display:flex; flex-direction:column; gap:6px; }
.nice-form input, .nice-form select, .nice-form textarea{
  width:100%; padding:10px; border-radius:10px; border:1px solid #e2e2e2; font-size:14px; background:#fff;
  box-shadow: inset 0 0 0 transparent; transition: border .2s ease, box-shadow .2s ease;
}
.nice-form input:focus, .nice-form select:focus, .nice-form textarea:focus{ border-color:var(--accent); box-shadow: 0 0 0 3px rgba(244,109,160,0.12); outline:none; }

/* ===========================
   Responsive tweaks
   =========================== */

/* For mobile and small tablets force single column and ensure children can shrink */
@media (max-width: 980px) {
  .layout{ grid-template-columns: minmax(0,1fr) !important; gap:12px; padding:12px; }
  .layout > *{ width:100%; min-width:0 !important; }
  .products{ grid-template-columns: repeat(auto-fit, minmax(120px,1fr)) !important; gap:10px; }
  .product img{ height:110px !important; }
  header .brand{ flex-wrap:wrap; }
  body{ padding-bottom:120px; } /* más espacio para footer en móvil */
}

/* very small phones */
@media (max-width:420px){
  .product img{ height:100px !important; }
  .wrap{ padding:10px; }
  .card{ padding:12px; border-radius:12px; }
}

/* final safety: prevent global overflow horizontal */
html, body, .wrap, .layout, .products, .card { min-width:0; }


/* --- Fix: product footer (precio + botón) responsive --- */
.product-foot{
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap; /* permite que el botón baje de línea si falta espacio */
}

/* que el precio quede natural y no haga wrap raro */
.product-foot .price{
  flex: 0 0 auto;
  white-space: nowrap;
  margin-right: 6px;
}

/* contenedor para el/los botones (mantiene ellos a la derecha) */
.product-foot .actions{
  margin-left: auto;
  display: flex;
  gap: 8px;
  align-items: center;
}

/* botones un poquito más compactos para que entren mejor */
.product .btn-primary,
.product .btn-ghost{
  padding: 6px 10px;
  min-width: 64px; /* ancho mínimo razonable */
  white-space: nowrap;
  font-size: 13px;
}

/* En pantallas muy angostas: poner el botón en la siguiente fila y alinearlo a la derecha */
@media (max-width: 520px){
  .product-foot{
    align-items: flex-start;
  }
  .product-foot .price{
    flex: 1 1 100%;
    margin-bottom: 6px;
  }
  .product-foot .actions{
    margin-left: 0;
    width: 100%;
    justify-content: flex-end;
  }
  .product .btn-primary{ padding-left:10px; padding-right:10px; }
}

/* ============================
   HERO SECTION
============================= */
.hero{
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 50px 10px;
    margin-bottom: 30px;
    background: linear-gradient(180deg, #fff0f6 0%, #e7f6fa 100%);
    border-radius: 20px;
    box-shadow: var(--shadow);
    gap: 20px;
}

.hero-content{
    max-width: 460px;
}

.hero-title{
    font-size: 42px;
    font-weight: 800;
    line-height: 1.1;
    margin: 0 0 12px 0;
    color: #2b2b2b;
}

.hero-subtitle{
    font-size: 18px;
    color: var(--muted);
    margin-bottom: 20px;
}

.hero-btn{
    background: linear-gradient(90deg,var(--accent),var(--accent-2));
    padding: 14px 26px;
    color: #fff;
    font-weight: 700;
    border-radius: 14px;
    border: none;
    cursor: pointer;
    font-size: 16px;
}

.hero-image img{
    width: 280px;
    height: 280px;
    object-fit: cover;
    border-radius: 20px;
    box-shadow: var(--shadow);
}

/* Mobile */
@media(max-width: 780px){
    .hero{
        flex-direction: column-reverse;
        text-align: center;
        padding: 35px 20px;
    }

    .hero-title{
        font-size: 32px;
    }

    .hero-subtitle{
        font-size: 16px;
    }

    .hero-image img{
        width: 220px;
        height: 220px;
    }
}



</style>

</head>

<body>

<div class="wrap">
<header>
    <div class="brand">
        <div class="logo">
            <img src="https://i.imgur.com/7eiCAM6.jpeg">
        </div>
        <div>
            <h1>Ice Cream Rolls — Pedidos</h1>
            <p class="lead">Artesanales • Personalizá tu roll • Pedí al instante</p>
        </div>
    </div>
</header>

<!-- ===================================== -->
<!-- HERO PRINCIPAL                        -->
<!-- ===================================== -->
<section class="hero">
    <div class="hero-content">
        <h1 class="hero-title">Helado Tailandes</h1>
        <p class="hero-subtitle">Elegí tu sabor, personalizá con toppings y recibilo al instante.</p>
        <button class="hero-btn" onclick="scrollToProducts()">Hacer pedido</button>
    </div>

    <div class="hero-image">
        <img src="https://i.imgur.com/7eiCAM6.jpeg" alt="Ice Cream Rolls">
    </div>
</section>

<div id="productsStart"></div>


<div class="layout">

    <!-- COLUMNA IZQUIERDA: productos -->
    <div class="card">
        <h2>Elegí tus sabores</h2>
        <p class="lead" style="font-size:13px">Podés personalizar cada roll y agregar varios.</p>

        <div style="height:10px"></div>

        <div id="productsArea" class="products"></div>
    </div>

    <!-- COLUMNA DERECHA: sidebar que contiene carrito + formulario -->
    <div class="sidebar">

  

  <!-- PANEL: Resumen / carrito -->
  <div class="card" style="margin-bottom:12px;">
    <h3 style="margin:0 0 8px 0">Tu pedido</h3>
    <div id="cartList" class="cart-list">
      <div class="small" style="color:var(--muted)">No hay items todavía</div>
    </div>

    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
      <div>
        <div class="small">Subtotal</div>
        <div id="total" style="font-weight:800">$0</div>
      </div>
    </div>
  </div>

  <!-- FORMULARIO (debajo del carrito) -->
  <div class="card nice-form">
    <h3 style="margin-top:0;">Datos del cliente</h3>

    <div class="form-field">
      <label>Nombre</label>
      <input id="custName" type="text" placeholder="Tu nombre">
    </div>

    <div class="form-field">
      <label>Teléfono</label>
      <input id="custPhone" type="tel" placeholder="Ej: 3764xxxxxx">
    </div>

    <div class="form-field">
      <label>Retiro o Entrega</label>
      <select id="deliveryMode">
        <option value="pickup">Retiro en local</option>
        <option value="delivery">Envío a domicilio</option>
      </select>
    </div>

    <div id="addressBlock" class="form-field" style="display:none;">
      <label>Dirección</label>
      <input id="custAddress" type="text" placeholder="Calle, número...">
    </div>

    <div class="form-field">
      <label>Método de pago</label>
      <select id="paymentMethod">
        <option value="cash">Efectivo</option>
        <option value="transfer">Transferencia</option>
      </select>

      <div id="paymentNotice" class="payment-msg">
        Para envíos solo aceptamos transferencia.
      </div>
    </div>

    <div class="form-field">
      <label>Notas (opcional)</label>
      <textarea id="custNotes" rows="2" placeholder="Ej: sin azúcar / venir a tal hora"></textarea>
    </div>

    <button id="checkoutBtn2" class="btn btn-primary" style="width:100%; margin-top:10px;">
      Enviar pedido
    </button>
  </div>

</div>
<!-- FIN SIDEBAR -->




</div><!-- END layout -->


</div><!-- END wrap -->


<!-- Footer fijo mejorado -->
<div class="fixed-footer">
  <div class="footer-left" style="display:flex;align-items:center;gap:12px;">
    <div style="font-weight:800;font-size:16px">Total: <span id="fixedTotal">$0</span></div>
  </div>

  <div class="footer-actions" style="display:flex;gap:8px;align-items:center;">
    <button id="footerAddBtn" class="btn btn-ghost" title="Agregar otro roll" style="padding:8px 10px;">Menú</button>
    <button id="footerFormBtn" class="btn btn-ghost" title="Completar datos" style="padding:8px 10px;">Cliente</button>
    <button id="footerClearBtn" class="btn btn-ghost" title="Vaciar carrito" style="padding:8px 10px;">Vaciar</button>
    <button id="fixedSendBtn" class="fixed-button" style="padding:10px 14px;">Enviar pedido</button>
  </div>
</div>



<!-- Modal -->
<div id="modal">
    <div class="sheet">

        <div style="display:flex;gap:14px;align-items:center;">
            <img id="modalImg" src="">
            <div>
                <h2 id="modalTitle" style="margin:0;font-size:18px;font-weight:700"></h2>
                <div id="modalBasePrice" class="lead" style="font-size:13px"></div>
            </div>
        </div>

        <h3 style="margin-top:18px">Toppings</h3>
        <div id="modalToppings" class="topping-grid"></div>
        <div class="lead" style="font-size:12px;color:#777;margin-top:4px">
            El primer topping es gratis
        </div>

        <h3 style="margin-top:18px">Salsas</h3>
        <div id="modalSauces" class="sauce-list">
            <div class="sauce" data-s="Chocolate">Chocolate</div>
            <div class="sauce" data-s="Dulce de leche">Dulce de leche</div>
            <div class="sauce" data-s="Frutilla">Frutilla</div>
        </div>

        <h3 style="margin-top:18px">Cantidad</h3>
        <input id="modalQty" type="number" min="1" value="1" style="width:120px">

        <!-- FIX aplicado: actions-row -->
        <div class="actions-row" style="display:flex;gap:8px;justify-content:flex-end;margin-top:14px;align-items:center">
            <div id="modalLinePrice" style="font-weight:700;color:var(--accent);">$0</div>
            <button id="addToCartBtn" class="btn btn-primary">Agregar al carrito</button>
            <button class="btn btn-ghost" onclick="closeModal()">Cancelar</button>
        </div>

    </div>
</div>



<!-- ======================= -->
<!--        JAVASCRIPT       -->
<!-- ======================= -->

<script>
    function scrollToProducts(){
    document.getElementById("productsStart").scrollIntoView({ behavior: "smooth" });
    }


    /* CONFIG */
    const PHONE = "5493764102637";
    const BASE_PRICE_DEFAULT = 2500;
    const TOPPING_EXTRA_PRICE = 300;

    /* Productos (con misma imagen) */
    const flavors = [
    { id:"oreo", name:"Oreo", price:2500, img:"https://i.imgur.com/7eiCAM6.jpeg" },
    { id:"choco", name:"Chocolate", price:2500, img:"https://i.imgur.com/7eiCAM6.jpeg" },
    { id:"fruit", name:"Frutilla", price:2500, img:"https://i.imgur.com/7eiCAM6.jpeg" },
    { id:"chocot", name:"Chocotorta", price:2500, img:"https://i.imgur.com/7eiCAM6.jpeg" },
    { id:"tira", name:"Tiramisu", price:2500, img:"https://i.imgur.com/7eiCAM6.jpeg" }
    ];

    const toppings = ["Maní","Chips de colores","Chips de chocolate","Oreo","Rocklets","Coco rallado"];

    let cart = [];
    let editingItemId = null;
    let currentFlavor = null;


    /* Helpers */
    function $(s){ return document.querySelector(s); }
    function $$(s){ return document.querySelectorAll(s); }
    function fmt(n){ return "$" + Number(n).toLocaleString("es-AR"); }


    /* Render productos */
    function renderProducts(){
        const area = $("#productsArea");
        area.innerHTML = "";
        flavors.forEach(f=>{
            const box = document.createElement("div");
            box.className = "product";
            box.innerHTML = `
                <img src="${f.img}" onerror="this.onerror=null;this.src='https://via.placeholder.com/400x300?text=Ice+Cream'">
                <div class="product-body">
                    <div class="product-title">${f.name}</div>
                    <div class="product-foot" style="display:flex;justify-content:space-between;align-items:center;margin-top:6px">
                        <div class="price">${fmt(f.price)}</div>
                        <button class="btn btn-primary" onclick="startNewModal('${f.id}','${f.name}')">Armar</button>
                    </div>
                </div>
            `;
            area.appendChild(box);
        });
    }


    // Helper: abrir modal para CREAR un nuevo ítem (limpia editingItemId)
    function startNewModal(id, name){
        editingItemId = null;    // declaramos que es un nuevo ítem
        openModal(id, name);
    }

    // Modal para personalizar (NO resetea editingItemId — así permite editar correctamente)
    function openModal(id, name){
        // NO hacemos editingItemId = null aquí (importante)
        currentFlavor = flavors.find(f=>f.id===id);

        $("#modalTitle").textContent = name;
        $("#modalImg").src = currentFlavor.img;
        $("#modalBasePrice").textContent = "Base: " + fmt(currentFlavor.price);
        $("#modalQty").value = 1;

        // toppings
        const t = $("#modalToppings");
        t.innerHTML = "";
        toppings.forEach(tp=>{
            const el = document.createElement("label");
            el.className="chip";
            el.innerHTML = `<input type="checkbox" value="${tp}"> ${tp}`;
            el.querySelector("input").addEventListener("change", updateModalPrice);
            t.appendChild(el);
        });

        // sauces
        $("#modalSauces").querySelectorAll(".sauce").forEach(s=>{
            s.classList.remove("active");
            s.onclick = ()=>{
                $("#modalSauces").querySelectorAll(".sauce").forEach(x=>x.classList.remove("active"));
                s.classList.add("active");
                updateModalPrice();
            }
        });

        updateModalPrice();

        $("#modal").style.display="flex";
        document.body.style.overflow="hidden";
    }


    function closeModal(){
        $("#modal").style.display="none";
        document.body.style.overflow="auto";
    }

    function updateModalPrice(){
        const qty = Math.max(1, parseInt($("#modalQty").value||"1"));
        const checked = [...$("#modalToppings").querySelectorAll("input:checked")].map(i=>i.value);
        const extra = Math.max(0, checked.length-1) * TOPPING_EXTRA_PRICE;
        $("#modalLinePrice").textContent = fmt((currentFlavor.price+extra)*qty);
    }


    /* Add to cart */
    $("#addToCartBtn").onclick = ()=>{
        const qty = Math.max(1, parseInt($("#modalQty").value||"1"));
        const selectedToppings = [...$("#modalToppings").querySelectorAll("input:checked")].map(i=>i.value);
        const sauceEl = $("#modalSauces").querySelector(".sauce.active");
        const sauce = sauceEl ? sauceEl.dataset.s : "";

        const extraPerUnit = Math.max(0, selectedToppings.length-1) * TOPPING_EXTRA_PRICE;
        const itemTotal = (currentFlavor.price + extraPerUnit) * qty;

        if(editingItemId){
            const it = cart.find(x=>x.id===editingItemId);
            it.qty = qty;
            it.toppings = selectedToppings;
            it.sauce = sauce;
            it.unitPrice = currentFlavor.price;
        } else {
            cart.push({
                id:"i"+Date.now(),
                flavorName: currentFlavor.name,
                flavorId: currentFlavor.id,
                qty: qty,
                toppings: selectedToppings,
                sauce: sauce,
                unitPrice: currentFlavor.price
            });
        }

        closeModal();
        renderCart();
    };


    /* Render cart */
    function calcItemTotal(it){
        const extra = Math.max(0, it.toppings.length-1)*TOPPING_EXTRA_PRICE;
        return (it.unitPrice+extra)*it.qty;
    }

        function renderCart(){
            const list = $("#cartList");

            // Calculamos total aunque la UI no exista, para mantener lógica intacta
            let total = 0;
            cart.forEach(it => total += calcItemTotal(it));

            // Si no hay contenedor visual del carrito, al menos actualizamos el footer fijo y salimos
            if(!list){
                const fixedEl = document.getElementById("fixedTotal");
                if(fixedEl) fixedEl.textContent = fmt(total);
                return;
            }

            // Si existe el contenedor, renderizamos las filas
            list.innerHTML = "";

            if(cart.length === 0){
                list.innerHTML = '<div class="small" style="color:var(--muted)">No hay items todavía</div>';
            } else {
                cart.forEach(it=>{
                    const row = document.createElement("div");
                    row.className="cart-row";
                    row.innerHTML = `
                        <div>
                            <b>${it.qty}× ${it.flavorName}</b><br>
                            <span class="small">${(it.toppings && it.toppings.length) ? it.toppings.join(", ") : "Sin toppings"} • ${it.sauce || "Sin salsa"}</span>
                        </div>
                        <div style="text-align:right">
                            <b>${fmt(calcItemTotal(it))}</b><br>
                            <button class="btn btn-ghost" style="margin-top:6px;font-size:12px" onclick="editItem('${it.id}')">Editar</button>
                            <button class="btn btn-ghost" style="margin-top:6px;font-size:12px" onclick="removeItem('${it.id}')">Eliminar</button>
                        </div>
                    `;
                    list.appendChild(row);
                });
            }

            // Actualizar total en el elemento #total si existe
            const totalEl = document.getElementById("total");
            if (totalEl) totalEl.textContent = fmt(total);

            // Actualizar footer fijo si existe
            const fixedEl = document.getElementById("fixedTotal");
            if (fixedEl) fixedEl.textContent = fmt(total);
        }


    function editItem(id){
        editingItemId = id;
        const it = cart.find(x=>x.id===id);
        openModal(it.flavorId, it.flavorName);

        $("#modalQty").value = it.qty;

        // toppings
        $("#modalToppings").querySelectorAll("input").forEach(ch=>{
            if(it.toppings.includes(ch.value)) ch.checked = true;
        });

        // sauce
        $("#modalSauces").querySelectorAll(".sauce").forEach(s=>{
            if(s.dataset.s === it.sauce) s.classList.add("active");
        });

        updateModalPrice();
    }

    function removeItem(id){
        cart = cart.filter(x=>x.id!==id);
        renderCart();
    }

    /* Delivery select: dirección + reglas de pago */
    $("#deliveryMode").onchange = () => {
    const mode = $("#deliveryMode").value;
    const addr = $("#addressBlock");
    const pay = document.getElementById("paymentMethod");
    const notice = document.getElementById("paymentNotice");
    const cashOpt = pay.querySelector('option[value="cash"]');

    // Mostrar/ocultar dirección
    addr.style.display = (mode === "delivery") ? "block" : "none";

    if (mode === "delivery") {
        // Forzar transferencia
        pay.value = "transfer";
        if (cashOpt) cashOpt.disabled = true;

        // Mostrar aviso
        notice.style.display = "block";
    } else {
        // Habilitar efectivo nuevamente
        if (cashOpt) cashOpt.disabled = false;

        // Ocultar aviso
        notice.style.display = "none";
    }
    };



    /* WhatsApp */
    function sendWhatsApp(){
        if(cart.length===0){
            alert("Tu carrito está vacío.");
            return;
        }

        let name = $("#custName").value.trim();
        let phone = $("#custPhone").value.trim();
        if(!name){ alert("Ingresá tu nombre."); return; }
        if(!phone){ alert("Ingresá tu teléfono."); return; }

        let mode = $("#deliveryMode").value;
        let address = $("#custAddress").value.trim();

        if(mode==="delivery" && !address){
            alert("Ingresá la dirección.");
            return;
        }

        let pay = $("#paymentMethod").value;
        let notes = $("#custNotes").value.trim();

        // Construir mensaje legible y seguro
        let text = "Nuevo pedido\n\n";
        cart.forEach((it,i)=>{
        text += `${i+1}) ${it.qty}× ${it.flavorName}\n`;
        text += `Toppings: ${ (it.toppings && it.toppings.length) ? it.toppings.join(", ") : "Sin toppings" }\n`;
        text += `Salsa: ${it.sauce || "Sin salsa"}\n`;
        text += `Subtotal: ${fmt(calcItemTotal(it))}\n\n`;
        });

        const totalAmount = cart.reduce((s,it)=> s + calcItemTotal(it), 0);
        text += `Total: ${fmt(totalAmount)}\n\n`;
        text += `Cliente: ${name}\nTel: ${phone}\n`;
        text += `Entrega: ${mode==="pickup" ? "Retiro" : "Envío"}\n`;
        if(mode==="delivery") text += `Dirección: ${address}\n`;
        text += `Pago: ${pay==="cash"?"Efectivo":"Transferencia"}\n`;
        if(notes) text += `Notas: ${notes}\n`;

        // abrir WhatsApp
        const url = `https://wa.me/${PHONE}?text=` + encodeURIComponent(text);
        window.open(url, "_blank");

    }

    $("#fixedSendBtn").onclick = sendWhatsApp;


    // --- Helpers para footer botones (defensivos: no rompen si ya existen) ---
    function scrollToProducts(){
    const el = document.querySelector('.products');
    if(el) el.scrollIntoView({behavior:'smooth', block:'start'});
    }

    function scrollToForm(){
    const el = document.querySelector('.nice-form');
    if(el) el.scrollIntoView({behavior:'smooth', block:'start'});
    }

    function clearCart(){
    if(!cart || !cart.length) return;
    if(!confirm("¿Vaciar el carrito?")) return;
    cart = [];
    renderCart();
    }

    // Hook botones del footer (asegura que existan en el DOM)
    document.addEventListener('DOMContentLoaded', () => {
    const addBtn = document.getElementById('footerAddBtn');
    if(addBtn) addBtn.addEventListener('click', scrollToProducts);

    const formBtn = document.getElementById('footerFormBtn');
    if(formBtn) formBtn.addEventListener('click', scrollToForm);

    const clearBtn = document.getElementById('footerClearBtn');
    if(clearBtn) clearBtn.addEventListener('click', clearCart);

    // fixedSendBtn ya existía y apunta a sendWhatsApp en tu código; si no, lo seteamos:
    const sendBtn = document.getElementById('fixedSendBtn');
    if(sendBtn) sendBtn.addEventListener('click', sendWhatsApp);
    });






    /* INIT */
    renderProducts();
    renderCart();

    // Botón alternativo para Google Sites (llama directamente a la función de envío)
    document.getElementById("checkoutBtn2").addEventListener("click", sendWhatsApp);

    



</script>

</body>
</html>
